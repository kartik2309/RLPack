<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RLPack: Deep Q-Networks</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="RLPack-logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">RLPack
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_agents_dqn.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Deep Q-Networks </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >DQN-Agent is implemented as <code><a class="el" href="classrlpack_1_1dqn_1_1dqn__agent_1_1_dqn_agent.html" title="This class implements the basic DQN methodology, i.e.">rlpack.dqn.dqn_agent.DqnAgent</a></code>. All variants of DQN agents use the same class to run and train the DQN agent. This class is defined in <code>rlpack.dqn.dqn_agent.py</code> as <code>DqnAgent</code>. It inherits from <code>Agent</code> class defined in <code>rlpack.utils.base.agent.py</code>.</p>
<p >DQN implementation in RLPack is based on Dual Q-Networks with a trainable policy network and a frozen target network.</p>
<h3><a class="anchor" id="autotoc_md3"></a>
agent_name: "dqn"</h3>
<h1><a class="anchor" id="autotoc_md4"></a>
Implementations</h1>
<p >There are currently three supported implementations for DQN:</p>
<ul>
<li><p class="startli"><b>Uniform-Sampling based DQN</b></p>
<p class="startli">In this DQN variant, we populate the memory (also called transition buffer) with transitions and sample them as per uniform distribution. This essentially means that each transition we store in the bufer has equal probability of being sampled for next batch. To use this variant, set <code>prioritization_params=None</code> in <code>agent_args</code>.</p>
</li>
<li><p class="startli"><b>Proportional based DQN</b></p>
<p class="startli">In this DQN variant, we populate the memory (also called transition buffer) with transitions with each sample having a fixed priority (generally same of all samples initially) and sample them as per this priority. Probabilities and weights are computed from directly using TD Errors and updates are made accordingly. This was proposed by <a href="https://arxiv.org/pdf/1511.05952.pdf">Tom Schaul et al. (ICLR 2016)</a>. To use this variant, set <code>prioritization_params={..., "prioritization_strategy": "proportional"}</code></p>
</li>
<li><p class="startli"><b>Rank-based DQN</b></p>
<p class="startli">In this DQN variant, we populate the memory (also called transition buffer) with transitions with each sample having a fixed priority (generally same of all samples initially) and sample them as per this priority. Probabilities and weights are computed by sorting TD Errors to find each transition's ranks; updates are then made accordingly. This was proposed by <a href="https://arxiv.org/pdf/1511.05952.pdf">Tom Schaul et al. (ICLR 2016)</a>. To use this set <code>prioritization_params={..., "prioritization_strategy": "rank-based"}</code>.</p>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md5"></a>
Prioritization Parameters</h1>
<p >For Proportional based DQN and Rank-based DQN, it is mandatory that we set <code>prioritization_params</code> in <code>agent_args</code>. <code>prioritization_params</code> is a dictionary that must define some prioritization parameters we intend to use for training. Mandatory arguments for <code>prioritization_params</code> are:</p>
<ul>
<li><code>alpha</code>: The alpha value for prioritization. Alpha indicates the level of prioritization for transitions from memory, higher value implying more aggressive prioritization.</li>
<li><code>beta</code>: The beta value for bias correction. Beta indicates the level of bias correction by adjusting Important Sampling weights. The higher values of beta indicate the greater bias correction.</li>
<li><code>min_alpha</code>: The lower limit of <code>alpha</code>. This is the minimum value beta can reach during training. Default is set to 0 by <code>DqnAgent</code>.</li>
<li><code>max_beta</code>: The upper limit of <code>beta</code>. This is the maximum value beta can reach during training. Default is set to 1 by <code>DqnAgent</code>.</li>
<li><code>alpha_annealing_frequency</code>: This parameter indicates the number of timesteps after which the alpha is annealed.<ul>
<li>If <code>alpha_annealing_fn</code> is passed, this function is called every <code>alpha_annealing_frequency</code> timesteps.</li>
<li>If <code>None</code> is passed, <code>alpha</code> is not annealed.</li>
</ul>
</li>
<li><code>beta_annealing_frequency</code>: This parameter indicates the number of timesteps after which the beta is annealed.<ul>
<li>If <code>beta_annealing_fn</code> is passed, this function is called every <code>beta_annealing_frequency</code> timesteps.</li>
<li>If <code>None</code> is passed, <code>beta</code> is not annealed.</li>
</ul>
</li>
<li><code>alpha_annealing_fn</code>: The annealing function (or scheduler) to be used to anneal alpha. If this function requires extra arguments, they must be passed with another key <code>alpha_annealing_fn_args</code> as tuple or <code>alpha_annealing_fn_kwargs</code> as a dictionary of keyword arguments. The function definition's first argument must be alpha.</li>
<li><code>beta_annealing_fn</code>: The annealing function (or scheduler) to be used to anneal beta. If this function requires extra arguments, they must be passed with another key <code>beta_annealing_fn_args</code> as tuple or <code>beta_annealing_fn_kwargs</code> as a dictionary of keyword arguments. The function definition's first argument must be beta.</li>
<li><code>alpha_annealing_factor</code>: This is an optional argument that can be used, if not external <code>alpha_annealing_fn</code> is not supplied. This loads the default annealing function which decays alpha by the supplied factor.</li>
<li><code>beta_annealing_factor</code>: This is an optional argument that can be used, if not external <code>beta_annealing_fn</code> is not supplied. This loads the default annealing function which decays beta by the supplied factor. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
