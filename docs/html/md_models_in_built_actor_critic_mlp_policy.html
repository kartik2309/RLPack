<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RLPack: Actor Critic Multi-Layered Perceptron Policy</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="RLPack-logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">RLPack
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_models_in_built_actor_critic_mlp_policy.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Actor Critic Multi-Layered Perceptron Policy </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >RLPack implements the Actor Critic MLP Policy model for model-based learning. This model is implemented as <code><a class="el" href="classrlpack_1_1models_1_1actor__critic__mlp__policy_1_1_actor_critic_mlp_policy.html">rlpack.models.actor_critic_mlp_policy.ActorCriticMlpPolicy</a></code>. In the implementation provided by RLPack, the model uses an MLP based feature extractor which is coupled with two Linear heads for action logits and state value (<em>V(s)</em>). The model returns a tuple of PyTorch tensors with first value being action logits and second being the state value.</p>
<h3><a class="anchor" id="autotoc_md14"></a>
model_name: "actor_critic_mlp_policy"</h3>
<p >With RLPack's implementation, it is possible to easily tweak the network architecture on the fly without any intervention in code. <code>model_name: "actor_critic_mlp_policy"</code> is set, we have to pass to relevant <code>model_args</code> to the config dict. An example of <code>model_args</code> is: </p><div class="fragment"><div class="line">model_args = {</div>
<div class="line">  <span class="stringliteral">&quot;num_actions&quot;</span>: 4,</div>
<div class="line">  <span class="stringliteral">&quot;sequence_length&quot;</span>: 1,</div>
<div class="line">  <span class="stringliteral">&quot;hidden_sizes&quot;</span>: [ 8, 64, 128, 256, 512 ],</div>
<div class="line">  <span class="stringliteral">&quot;dropout&quot;</span>: 0.1</div>
<div class="line">}</div>
</div><!-- fragment --><p> here</p><ul>
<li><code>num_actions</code> is the number of actions of the agent (for discrete action space).</li>
<li><code>sequence_length</code> is the length of sequence of input data. Depending on how states are reshaped, this can be 1 or above, but has to be at least 1. In cases where states are vectors, it can be reshaped manually before calling the agent's train function, or better yet, pass <code>new_shape</code> in the config dict to reshape the input under the hood. For example if states are vectors of shape <code>(4, )</code>, we can pass <code>"new_shape": [1, 4]</code> in the config dict. This reshapes the input accordingly. Consequently, we can see that sequence length is 1, hence we can set <code>sequence_length</code> to 1.</li>
<li><code>hidden_sizes</code>: The hidden features of each layer of the MLP. The first element of the list passed here must be corresponding to the number of features in states. Following the previous example provided in explanation of <code>sequence_length</code>, the first layer must have the size of 4, hence <code>"hidden_sizes": [4, ...]</code>. Depending on <code>new_shape</code> passed in config dict, this can be adjusted accordingly.</li>
<li><code>dropout</code>: The dropout probability to be applied on the last layer.</li>
</ul>
<p >The activation (keyed <code>activation_args</code>) is applied at the output of each layer except the final layer. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
